(function(t){function e(e){for(var o,i,r=e[0],c=e[1],l=e[2],u=0,m=[];u<r.length;u++)i=r[u],Object.prototype.hasOwnProperty.call(n,i)&&n[i]&&m.push(n[i][0]),n[i]=0;for(o in c)Object.prototype.hasOwnProperty.call(c,o)&&(t[o]=c[o]);d&&d(e);while(m.length)m.shift()();return s.push.apply(s,l||[]),a()}function a(){for(var t,e=0;e<s.length;e++){for(var a=s[e],o=!0,r=1;r<a.length;r++){var c=a[r];0!==n[c]&&(o=!1)}o&&(s.splice(e--,1),t=i(i.s=a[0]))}return t}var o={},n={app:0},s=[];function i(e){if(o[e])return o[e].exports;var a=o[e]={i:e,l:!1,exports:{}};return t[e].call(a.exports,a,a.exports,i),a.l=!0,a.exports}i.m=t,i.c=o,i.d=function(t,e,a){i.o(t,e)||Object.defineProperty(t,e,{enumerable:!0,get:a})},i.r=function(t){"undefined"!==typeof Symbol&&Symbol.toStringTag&&Object.defineProperty(t,Symbol.toStringTag,{value:"Module"}),Object.defineProperty(t,"__esModule",{value:!0})},i.t=function(t,e){if(1&e&&(t=i(t)),8&e)return t;if(4&e&&"object"===typeof t&&t&&t.__esModule)return t;var a=Object.create(null);if(i.r(a),Object.defineProperty(a,"default",{enumerable:!0,value:t}),2&e&&"string"!=typeof t)for(var o in t)i.d(a,o,function(e){return t[e]}.bind(null,o));return a},i.n=function(t){var e=t&&t.__esModule?function(){return t["default"]}:function(){return t};return i.d(e,"a",e),e},i.o=function(t,e){return Object.prototype.hasOwnProperty.call(t,e)},i.p="";var r=window["webpackJsonp"]=window["webpackJsonp"]||[],c=r.push.bind(r);r.push=e,r=r.slice();for(var l=0;l<r.length;l++)e(r[l]);var d=c;s.push([0,"chunk-vendors"]),a()})({0:function(t,e,a){t.exports=a("56d7")},"115d":function(t,e,a){},"56d7":function(t,e,a){"use strict";a.r(e);a("a79d");var o=a("2b0e"),n=a("b079"),s=a.n(n),i=function(){var t=this,e=t.$createElement,a=t._self._c||e;return a("div",{ref:"app",class:t.layout.mode,attrs:{id:"app",tabindex:"0"}},[a("svg-sprite",{on:{loaded:function(e){t.layout.icons=e,t.layout.showLoader=!1}}}),a("prompt",{attrs:{data:t.prompt},on:{callback:function(e){return t.promptCallback(e)}}}),a("undo",{directives:[{name:"show",rawName:"v-show",value:t.layout.showUndo,expression:"layout.showUndo"}],ref:"undo",attrs:{db:t.db},on:{undo:function(e){t.db=e,t.sync()},show:function(e){t.layout.showUndo=!0},timer:function(e){t.layout.showUndo=!1}},nativeOn:{click:function(e){t.layout.showUndo=!1}}}),a("div",{directives:[{name:"show",rawName:"v-show",value:t.layout.showLoader,expression:"layout.showLoader"}],attrs:{id:"loader"}},[a("div",{staticClass:"icon"})]),a("editor",{attrs:{db:t.db,layout:t.layout,options:t.options},on:{"switch-mode":function(e){return t.switchMode(e)},edit:function(e){return t.editKnob(e)},loading:function(e){t.layout.showLoader=e}}}),a("tabs",{attrs:{db:t.db,layout:t.layout},on:{"switch-tab":function(e){t.layout.activeTab=e},"switch-mode":function(e){return t.switchMode(e)},save:function(e){return t.saveTab(e)},remove:function(e){t.prompt={message:"Are you sure you want to delete tab? "+t.layout,callback:"removeTab",data:e}}}}),a("remote",{attrs:{db:t.db,layout:t.layout,options:t.options},on:{"switch-mode":function(e){return t.switchMode(e)},sort:function(e){return t.sync("sort")},remove:function(e){t.prompt={message:"Are you sure?",callback:"removeKnob"}}}})],1)},r=[],c=function(){var t=this,e=t.$createElement,a=t._self._c||e;return a("div",{attrs:{id:"svg-sprite"}})},l=[],d={data(){return{glyphs:[]}},mounted(){this.load()},methods:{load(){fetch("icons/sprite.svg").then(t=>{if(!t.ok)throw new Error("API HTTP status "+t.status);return t.text()}).then(t=>{this.parse(t)}).catch(t=>{this.$toast.error(String(t))})},parse(t){const e=document.getElementById("svg-sprite"),a=(new DOMParser).parseFromString(t,"text/xml"),o=a.getElementsByTagName("symbol");if(!o.length)throw new Error("Cannot generate svg icons");e.innerHTML=t;for(let n=0;n<o.length;n+=1)this.glyphs.push(o[n].getAttribute("id"));this.$emit("loaded",this.glyphs)}}},u=d,m=(a("fc63"),a("2877")),h=Object(m["a"])(u,c,l,!1,null,null,null),p=h.exports,f=function(){var t=this,e=t.$createElement,a=t._self._c||e;return a("a",{ref:"undoButton",attrs:{href:"#"},on:{keydown:function(e){return(e.type.indexOf("key")||90===e.keyCode)&&e.ctrlKey?t.undo(e):null},click:function(e){return e.preventDefault(),t.undo(e)}}},[a("span",[t._v("Undo")]),a("svg",[a("use",{attrs:{"xlink:href":"#fast-forward"}})])])},v=[],b={props:{db:{type:Object,required:!0}},data(){return{db_history:{}}},mounted(){this.$refs.undoButton.focus()},methods:{undo(){this.$emit("undo",this.db_history)},record(){this.db_history=JSON.parse(JSON.stringify(this.db)),this.timer(),this.$emit("show")},timer(){setTimeout(()=>{this.$emit("timer")},5e3)}}},y=b,k=(a("ae89"),Object(m["a"])(y,f,v,!1,null,"685f8fd0",null)),g=k.exports,_=function(){var t=this,e=t.$createElement,a=t._self._c||e;return a("div",{attrs:{id:"add-overlay"},on:{click:function(e){return t.closeModal(e)}}},[a("form",{class:{disabled:t.knobSaveData.isPlaceholder},attrs:{action:"#",id:"form1",autocomplete:"off"},on:{submit:function(e){return t.validate()},keydown:function(e){return!e.type.indexOf("key")&&t._k(e.keyCode,"esc",27,e.key,["Esc","Escape"])?null:t.closeModal(e,!0)}}},[a("div",{staticClass:"close",on:{click:function(e){return t.closeModal(e)}}}),t._m(0),a("input",{directives:[{name:"model",rawName:"v-model",value:t.knobSaveData.name,expression:"knobSaveData.name"}],ref:"editorNameField",attrs:{type:"text",id:"knob_name",required:""},domProps:{value:t.knobSaveData.name},on:{input:function(e){e.target.composing||t.$set(t.knobSaveData,"name",e.target.value)}}}),t._m(1),a("div",{attrs:{id:"mqtt"}},[a("input",{directives:[{name:"model",rawName:"v-model",value:t.knobSaveData.mqtt,expression:"knobSaveData.mqtt"}],attrs:{type:"text",id:"knob_mqtt",required:""},domProps:{value:t.knobSaveData.mqtt},on:{input:function(e){e.target.composing||t.$set(t.knobSaveData,"mqtt",e.target.value)}}}),a("button",{attrs:{type:"button"},on:{click:function(e){return e.preventDefault(),t.recordIR()}}},[t._v("Listen")])]),t._m(2),a("div",{attrs:{id:"knob_mqtt_topic"}},t._l(t.options.settings.topic_send,(function(e,o){return a("p",{key:o},[a("input",{directives:[{name:"model",rawName:"v-model",value:t.knobSaveData.topic_send,expression:"knobSaveData.topic_send"}],ref:"mqtt-checkbox-"+o,refInFor:!0,attrs:{type:"radio",required:"",id:"mqtt-label-"+o},domProps:{value:e,checked:t._q(t.knobSaveData.topic_send,e)},on:{change:function(a){return t.$set(t.knobSaveData,"topic_send",e)}}}),a("label",{attrs:{for:"mqtt-label-"+o}},[t._v(t._s(e))])])})),0),a("label",{attrs:{for:"knob_id"}},[t._v("Unique id "),a("span",{staticClass:"mono"},[t._v(" $ curl "+t._s(t.options.settings.hostname)+t._s(t.options.api.send)+t._s(t.knobSaveData.id)+"/ ")])]),a("input",{directives:[{name:"model",rawName:"v-model",value:t.knobSaveData.id,expression:"knobSaveData.id"}],attrs:{type:"text",id:"knob_id",required:"",readonly:""},domProps:{value:t.knobSaveData.id},on:{input:function(e){e.target.composing||t.$set(t.knobSaveData,"id",e.target.value)}}}),t._m(3),a("input",{directives:[{name:"model",rawName:"v-model",value:t.knobSaveData.icon,expression:"knobSaveData.icon"}],ref:"icon",attrs:{type:"text",id:"knob_icon"},domProps:{value:t.knobSaveData.icon},on:{input:function(e){e.target.composing||t.$set(t.knobSaveData,"icon",e.target.value)}}}),a("div",{attrs:{id:"glyphs"}},t._l(t.filteredIcons,(function(e){return a("div",{key:e,staticClass:"glyph",attrs:{title:e},domProps:{innerHTML:t._s(t.renderIcon(e))},on:{click:function(a){t.knobSaveData.icon=e,t.$refs.icon.focus()}}})})),0),t._m(4),a("input",{directives:[{name:"model",rawName:"v-model",value:t.knobSaveData.color,expression:"knobSaveData.color"}],attrs:{type:"text",id:"knob_color"},domProps:{value:t.knobSaveData.color},on:{input:function(e){e.target.composing||t.$set(t.knobSaveData,"color",e.target.value)}}}),a("slider-picker",{model:{value:t.colors,callback:function(e){t.colors=e},expression:"colors"}}),a("div",{staticClass:"placeholder"},[a("input",{directives:[{name:"model",rawName:"v-model",value:t.knobSaveData.isPlaceholder,expression:"knobSaveData.isPlaceholder"}],ref:"knobType",attrs:{type:"checkbox",id:"knob-type"},domProps:{checked:Array.isArray(t.knobSaveData.isPlaceholder)?t._i(t.knobSaveData.isPlaceholder,null)>-1:t.knobSaveData.isPlaceholder},on:{change:function(e){var a=t.knobSaveData.isPlaceholder,o=e.target,n=!!o.checked;if(Array.isArray(a)){var s=null,i=t._i(a,s);o.checked?i<0&&t.$set(t.knobSaveData,"isPlaceholder",a.concat([s])):i>-1&&t.$set(t.knobSaveData,"isPlaceholder",a.slice(0,i).concat(a.slice(i+1)))}else t.$set(t.knobSaveData,"isPlaceholder",n)}}}),a("label",{attrs:{for:"knob-type"}},[t._v("Use as an empty placeholder")])]),a("button",{attrs:{form:"form1"},on:{click:function(e){return e.preventDefault(),t.validate()}}},[t._v("Save")]),t._m(5)],1)])},w=[function(){var t=this,e=t.$createElement,a=t._self._c||e;return a("label",{attrs:{for:"knob_name"}},[t._v("Name "),a("span",[t._v("Name for the knob")])])},function(){var t=this,e=t.$createElement,a=t._self._c||e;return a("label",{attrs:{for:"knob_mqtt"}},[t._v("MQTT response "),a("span",[t._v("Tap listen and press a remote button towards IR receiver")])])},function(){var t=this,e=t.$createElement,a=t._self._c||e;return a("label",{attrs:{for:"knob_mqtt_topic"}},[t._v("MQTT topic "),a("span",[t._v("Add new topics from HA configuration")])])},function(){var t=this,e=t.$createElement,a=t._self._c||e;return a("label",{attrs:{for:"knob_icon"}},[t._v("Icon "),a("span",[t._v("If no icon is selected, the name is being used")])])},function(){var t=this,e=t.$createElement,a=t._self._c||e;return a("label",{attrs:{for:"knob_color"}},[t._v("Color "),a("span",[t._v("Color for the icon. Leave blank for default that depends on the parent theme.")])])},function(){var t=this,e=t.$createElement,a=t._self._c||e;return a("p",{staticClass:"keybinds"},[a("strong",[t._v("Enter")]),t._v(" to save, "),a("strong",[t._v("Esc")]),t._v(" to close ")])}],D=(a("ddb0"),a("c345")),S={methods:{genUID(){return Math.random().toString(36).slice(-8)},getHostname(){let t="";return t},cssVar(t){return getComputedStyle(document.documentElement).getPropertyValue(t)},scaffoldDB(){return{default:{name:"Default",knobs:[{id:"wn0gbd99",name:"Samsung Volume Up",mqtt:'{"Protocol":"SAMSUNG","Bits":32,"Data":"0xE0E0E01F"}',icon:"up-arrow",topic_send:"irur/cmnd/IRsend",isPlaceholder:!1},{id:"wt9u3yzj",name:"Samsung Volume Down",mqtt:'{"Protocol":"SAMSUNG","Bits":32,"Data":"0xE0E0D02F"}',icon:"down-arrow",topic_send:"irur/cmnd/IRsend",isPlaceholder:!1}]}}}}},$={mixins:[S],components:{"slider-picker":D["Slider"]},props:{db:{type:Object,required:!0},layout:{type:Object,required:!0},options:{type:Object,required:!0}},watch:{layout:{deep:!0,handler(t,e){if("add"===e.mode&&(this.colors={hex:this.cssVar("--accent")},this.knobSaveData={isPlaceholder:!1,id:this.genUID(),name:"",mqtt:"",icon:"",color:this.cssVar("--accent"),topic_send:this.options.settings.topic_send},1===this.options.settings.topic_send.length&&([this.knobSaveData.topic_send]=this.options.settings.topic_send),this.$nextTick().then(()=>{this.$refs.editorNameField.focus()})),"edit"===e.mode){const t=JSON.parse(JSON.stringify(this.db[this.layout.activeTab].knobs[this.layout.activeEdit.index]));this.knobSaveData=t,void 0===this.knobSaveData.color&&(this.knobSaveData.color=this.cssVar("--accent")),this.colors={hex:this.knobSaveData.color},this.$nextTick().then(()=>{this.$refs.editorNameField.focus()})}}},colors(t){this.knobSaveData.color=t.hex}},data(){return{knobSaveData:{isPlaceholder:"",id:"",name:"",mqtt:"",topic_send:"",icon:"",color:this.cssVar("--accent")},colors:{hex:this.cssVar("--accent")},icons:[]}},computed:{filteredIcons(){return this.layout.icons.filter(t=>t.toLowerCase().indexOf(this.knobSaveData.icon.toLowerCase())>-1)}},methods:{save(){this.$emit("edit",this.knobSaveData),this.$emit("switch-mode",{mode:"normal"})},recordIR(){const t=this;this.$emit("loading",!0);const e=5,a=new AbortController,o=setTimeout(()=>{a.abort()},1e3*e);function n(){t.$emit("loading",!1),clearTimeout(o)}fetch(`${this.options.api.prefix}${this.options.api.receive}`,{signal:a.signal}).then(t=>{if(!t.ok)throw new Error("API HTTP status "+t.status);return t.json()}).then(e=>{n(),t.knobSaveData.mqtt=e.mqtt,this.$toast.info("Ir code received")}).catch(t=>{n(),"AbortError"===t.name?this.$toast.info(`Stopped listening after ${e} seconds of no incoming messages`):this.$toast.error(String(t))})},validate(){const t=this.knobSaveData,e=[t.name,t.mqtt,t.id,t.topic_send];!t.isPlaceholder&&e.some(t=>""===t||void 0===t)?this.$toast.error("Name, id, mqtt and topic required"):(this.save(),this.mode="normal")},renderIcon(t){return`<svg class="icon" style="fill: ${this.knobSaveData.color}">\n                <use xlink:href="#${t}"></use>\n              </svg>`},closeModal(t,e){(["add-overlay","close"].includes(t.target.id)||e)&&this.$emit("switch-mode",{mode:"normal"})}}},x=$,T=(a("58d3"),Object(m["a"])(x,_,w,!1,null,null,null)),P=T.exports,E=function(){var t=this,e=t.$createElement,a=t._self._c||e;return a("div",{attrs:{id:"tabs"}},[a("vue-context",{ref:"menu",scopedSlots:t._u([{key:"default",fn:function(e){return[a("li",[a("a",{attrs:{"data-name":"add"},on:{click:function(a){return a.preventDefault(),t.menu(a,e.data)}}},[t._v("Add")])]),a("li",[a("a",{attrs:{"data-name":"rename"},on:{click:function(a){return a.preventDefault(),t.menu(a,e.data)}}},[t._v("Rename")])]),a("li",["default"!==e.data?a("a",{attrs:{"data-name":"remove"},on:{click:function(a){return a.preventDefault(),t.menu(a,e.data)}}},[t._v("Remove")]):t._e()])]}}])}),t._l(t.db,(function(e,o){return a("div",{key:o,staticClass:"tab",class:{active:t.layout.activeTab===o},attrs:{"data-id":o},on:{contextmenu:function(e){return e.preventDefault(),t.$refs.menu.open(e,o)},click:function(e){return t.switchTab(o)}}},["tab-rename"===t.layout.mode&&t.layout.activeTab===o?a("input",{directives:[{name:"model",rawName:"v-model",value:t.tabSaveData.name,expression:"tabSaveData.name"}],ref:"tab-"+o,refInFor:!0,attrs:{type:"text"},domProps:{value:t.tabSaveData.name},on:{blur:function(e){return t.saveTab()},focus:function(a){t.tabSaveData.name=e.name},keyup:function(e){return!e.type.indexOf("key")&&t._k(e.keyCode,"enter",13,e.key,"Enter")?null:e.target.blur()},input:function(e){e.target.composing||t.$set(t.tabSaveData,"name",e.target.value)}}}):a("span",[t._v(" "+t._s(e.name)+" ")])])}))],2)},O=[],C=a("899b"),q={mixins:[S],components:{VueContext:C["a"]},props:{db:{type:Object,required:!0},layout:{type:Object,required:!0}},data(){return{tabSaveData:{id:"",name:""}}},methods:{switchTab(t){this.$emit("switch-tab",t)},saveTab(){this.$emit("save",{data:this.tabSaveData}),this.$emit("switch-mode",{mode:"normal"})},addTab(){const t=this.genUID();this.tabSaveData={name:"New",id:t},this.$emit("save",{data:this.tabSaveData,mode:"tab-rename"}),this.renameTab(t)},renameTab(t){this.tabSaveData.id=t,this.$emit("switch-tab",t),this.$emit("switch-mode",{mode:"tab-rename"}),this.$nextTick().then(()=>{this.$refs["tab-"+t][0].focus()})},removeTab(t){t===this.layout.activeTab&&this.$emit("switch-tab","default"),this.$emit("remove",t)},menu(t,e){switch(t.target.dataset.name){case"add":this.addTab();break;case"rename":this.renameTab(e);break;case"remove":this.removeTab(e);break}}}},j=q,A=(a("6f10"),Object(m["a"])(j,E,O,!1,null,null,null)),I=A.exports,N=function(){var t=this,e=t.$createElement,a=t._self._c||e;return a("div",[a("vue-context",{ref:"menu",scopedSlots:t._u([{key:"default",fn:function(e){return[a("li",[a("a",{attrs:{href:"#","data-id":"add"},on:{click:function(a){return a.preventDefault(),t.menu(a,e.data)}}},[t._v("Add")])]),a("li",[a("a",{attrs:{href:"#","data-id":"edit"},on:{click:function(a){return a.preventDefault(),t.menu(a,e.data)}}},[t._v("Edit")])]),a("li",[a("a",{attrs:{href:"#","data-id":"sort"},on:{click:function(a){return a.preventDefault(),t.menu(a,e.data)}}},[t._v("Sort")])]),a("li",[a("a",{attrs:{href:"#","data-id":"remove"},on:{click:function(a){return a.preventDefault(),t.menu(a,e.data)}}},[t._v("Remove")])])]}}])}),a("draggable",{attrs:{id:"remote",draggable:".item",disabled:"sort"!=this.layout.mode},on:{change:function(e){return t.$emit("sort")}},model:{value:t.filteredDB,callback:function(e){t.filteredDB=e},expression:"filteredDB"}},[a("div",{staticClass:"add",attrs:{slot:"footer",draggable:"false"},on:{click:function(e){return t.$emit("switch-mode",{mode:"add"})}},slot:"footer"},[a("div",{staticClass:"glyph"},[a("svg",{staticClass:"icon"},[a("use",{attrs:{"xlink:href":"#add"}})])])]),t._l(t.filteredDB,(function(e,o){return a("div",{key:e.id,staticClass:"item",attrs:{title:!e.isPlaceholder&&e.name,"data-placeholder":e.isPlaceholder||!1},on:{click:function(a){return t.sendIr(e.id,e.isPlaceholder)},contextmenu:function(a){return a.preventDefault(),t.$refs.menu.open(a,{id:e.id,index:o})}}},[e.icon?a("div",{staticClass:"glyph"},[a("svg",{staticClass:"icon",style:"fill: "+e.color+";"},[a("use",{attrs:{"xlink:href":"#"+e.icon}})])]):a("div",{class:"no-icon len-"+e.name.length,style:"style: "+e.color+";"},[t._v(" "+t._s(e.name)+" ")])])}))],2)],1)},M=[],U=a("310e"),B=a.n(U),V={components:{draggable:B.a,VueContext:C["a"]},props:{db:{type:Object,required:!0},layout:{type:Object,required:!0},options:{type:Object,required:!0}},watch:{db(){this.data=this.db}},data(){return{data:{default:{name:"Default",knobs:[]}}}},computed:{filteredDB:{get(){return this.data[this.layout.activeTab].knobs},set(t){this.data[this.layout.activeTab].knobs=t}}},methods:{menu(t,e){const a=t.target.dataset.id;this.$emit("switch-mode",{mode:a,id:e.id,index:e.index}),"remove"===a&&this.$emit("remove")},sendIr(t,e){if(!e||void 0===e){const e=this.options.api.prefix;fetch(`${e}${this.options.api.send}${t}/`).then(t=>{if(!t.ok)throw new Error("API HTTP status "+t.status)}).then(()=>{this.loader=!1}).catch(t=>{this.$toast.error(String(t)),this.loader=!1})}}}},H=V,L=(a("6b37"),Object(m["a"])(H,N,M,!1,null,null,null)),R=L.exports,F=function(){var t=this,e=t.$createElement,a=t._self._c||e;return t.isActive?a("div",{ref:"window",staticClass:"overlay",attrs:{tabindex:"-1"},on:{keydown:[function(e){return!e.type.indexOf("key")&&t._k(e.keyCode,"esc",27,e.key,["Esc","Escape"])?null:t.cancel()},function(e){return!e.type.indexOf("key")&&t._k(e.keyCode,"enter",13,e.key,"Enter")?null:t.yes()}]}},[a("div",{attrs:{id:"prompt"}},[a("div",{staticClass:"close",on:{click:function(e){return t.cancel()}}}),a("div",{staticClass:"message"},[t._v(" "+t._s(t.propData.message)+" ")]),a("div",{staticClass:"clearfix"},[a("button",{staticClass:"yes",attrs:{type:"button"},on:{click:function(e){return e.preventDefault(),t.yes()}}},[t._v("Yes")]),a("button",{staticClass:"cancel",attrs:{type:"button"},on:{click:function(e){return e.preventDefault(),t.cancel()}}},[t._v("Cancel")])])])]):t._e()},J=[],K={props:{data:{type:Object,required:!0}},computed:{propData(){return this.data},isActive(){return this.propData.callback&&null!==this.propData.message}},watch:{isActive(){this.isActive&&this.$nextTick().then(()=>{this.$refs.window.focus()})}},methods:{yes(){this.$emit("callback",!0)},cancel(){this.$emit("callback",!1)}}},G=K,Q=(a("97ce"),Object(m["a"])(G,F,J,!1,null,null,null)),z=Q.exports,Y=(a("a89b"),{name:"App",mixins:[S],components:{SvgSprite:p,Undo:g,Editor:P,Tabs:I,Remote:R,Prompt:z},data(){return{layout:{mode:"normal",showLoader:!0,showUndo:!1,activeTab:"default",activeEdit:{},icons:[]},options:{api:{prefix:this.getHostname()+"api/",receive:"ir/receive/",send:"ir/send/",save:"db/save/",load:"db/load/",settings:"settings/"},settings:{topic_send:""}},db:{default:{name:"Default",knobs:[]}},prompt:{message:null,data:null,callback:null}}},mounted(){this.loadTheme(),this.loadDatabase(),this.loadSettings()},methods:{loadTheme(){const t=t=>{const e=window.top.document.documentElement;return getComputedStyle(e).getPropertyValue("--"+t)},e=e=>{let a="";for(let o=0;o<e.length;o+=1)if(""!==t(e[o])){a=t(e[o]);break}return a},a=document.documentElement;a.style.setProperty("--accent",e(["primary-text-color","text-color"])),a.style.setProperty("--background",e(["primary-background-color","background-color"])),a.style.setProperty("--background-shade",e(["card-background-color"]))},loadDatabase(){const t=this.options.api.prefix;fetch(`${t}${this.options.api.load}`).then(t=>{if(!t.ok)throw new Error("API HTTP status "+t.status);return t.json()}).then(t=>{"error"===t.status?(this.db=this.scaffoldDB(),this.sync()):this.db=t}).catch(t=>{this.$toast.error(String(t))})},loadSettings(){const t=this.options.api.prefix;fetch(`${t}${this.options.api.settings}`).then(t=>{if(!t.ok)throw new Error("API HTTP status "+t.status);return t.json()}).then(t=>{this.options.settings=t}).catch(t=>{this.$toast.error(String(t))})},switchMode(t){const{mode:e,id:a,index:o}=t;this.layout.mode=e,this.layout.activeEdit={id:a,index:o},"normal"===this.layout.mode&&(this.loader=!1)},sync(t="normal"){const e=this.options.api.prefix;fetch(`${e}${this.options.api.save}`,{headers:{Accept:"application/json","Content-Type":"application/json"},method:"POST",body:JSON.stringify(this.db)}).then(e=>{if(this.layout.mode=t,!e.ok)throw new Error("API HTTP status "+e.status)}).catch(t=>{this.$toast.error(String(t))})},editKnob(t){"edit"===this.layout.mode?this.db[this.layout.activeTab].knobs[this.layout.activeEdit.index]=t:"add"===this.layout.mode&&this.db[this.layout.activeTab].knobs.push(t),this.sync()},removeKnob(){this.$refs.undo.record();const{index:t}=this.layout.activeEdit;this.$delete(this.db[this.layout.activeTab].knobs,t),this.sync()},saveTab(t){const{id:e,name:a}=t.data;!{}.hasOwnProperty.call(this.db,e)?this.db={...this.db,[e]:{name:a,knobs:[]}}:this.db[e].name=a,this.sync(t.mode)},removeTab(t){this.$refs.undo.record(),this.$delete(this.db,t),this.sync()},promptCallback(t){const{callback:e,data:a}=this.prompt;t&&e&&this[e](a),Object.keys(this.prompt).forEach(t=>{this.prompt[t]=void 0})}}}),W=Y,X=Object(m["a"])(W,i,r,!1,null,null,null),Z=X.exports;o["default"].config.productionTip=!1,o["default"].use(s.a,{duration:4e3,type:"default",position:"bottom"}),new o["default"]({render:t=>t(Z)}).$mount("#app")},"58d3":function(t,e,a){"use strict";var o=a("f08e"),n=a.n(o);n.a},"5bf7":function(t,e,a){},"6b37":function(t,e,a){"use strict";var o=a("5bf7"),n=a.n(o);n.a},"6f10":function(t,e,a){"use strict";var o=a("75aa"),n=a.n(o);n.a},"75aa":function(t,e,a){},"97ce":function(t,e,a){"use strict";var o=a("c965"),n=a.n(o);n.a},a89b:function(t,e,a){},ae89:function(t,e,a){"use strict";var o=a("c47f"),n=a.n(o);n.a},c47f:function(t,e,a){},c965:function(t,e,a){},f08e:function(t,e,a){},fc63:function(t,e,a){"use strict";var o=a("115d"),n=a.n(o);n.a}});
//# sourceMappingURL=app.53fe43b8.js.map